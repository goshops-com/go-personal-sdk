const AudioSearch=function(){let e,a,o,i,r,n={};async function s(s){let t=document.getElementById("gopersonal-audio-search-voiceMicContainer");if(o)a.stop();else{r&&clearTimeout(r),r=setTimeout(function(){o&&t.click()},5e3),t.querySelector(".gopersonal-audio-search-circle").classList.add("gopersonal-audio-search-active");try{let c=await navigator.mediaDevices.getUserMedia({audio:!0});a=new MediaRecorder(c),i=[],a.ondataavailable=e=>{i.push(e.data)},a.onstop=async()=>{t.querySelector(".gopersonal-audio-search-circle").classList.remove("gopersonal-audio-search-active"),t.querySelector(".gopersonal-audio-search-circle svg").classList.add("gopersonal-audio-search-fa-spin");let a=new Blob(i,{type:"audio/wav"}),r=new File([a],"grabacion_audio.wav",{type:"audio/wav"}),c=new FormData;c.append("file",r);try{var l;let d={type:"voice",...n},p=await window.gsSDK.voiceSearch(c,d);(l=p.query).replace(/[^a-zA-Z0-9 ]/g,""),s(p)}catch(g){console.error("Error during voice search:",g),s(null,g)}o=!1,e.style.display="none",t.querySelector(".gopersonal-audio-search-circle svg").classList.remove("gopersonal-audio-search-fa-spin")},a.start(1e3),o=!0}catch(l){console.error("Error accessing microphone:",l),t.querySelector(".gopersonal-audio-search-circle").classList.remove("gopersonal-audio-search-active"),s(null,l)}}}return{open:function(a={},i){e?n={...n,...a}:function a(i={}){n={...i},(e=document.createElement("div")).id="gopersonal-audio-search-voiceSearchOverlay",e.style.display="none",e.innerHTML=`
        <div class="gopersonal-audio-search-modal">
          <div class="gopersonal-audio-search-modal-header">
            <h2>B\xfasqueda por voz</h2>
            <span id="gopersonal-audio-search-closeVoiceSearch">&times;</span>
          </div>
          <div class="gopersonal-audio-search-modal-body">
            <p>Presiona el bot\xf3n para comenzar a grabar. Puedes grabar hasta 5 segundos.</p>
            <div id="gopersonal-audio-search-voiceMicContainer">
              <div class="gopersonal-audio-search-circle">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512" width="30" height="30"><path d="M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"/></svg>
              </div>
            </div>
          </div>
        </div>
      `,document.body.appendChild(e),function e(){let a=document.createElement("style");a.textContent=`
        #gopersonal-audio-search-voiceSearchOverlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
        }
        .gopersonal-audio-search-modal {
          background-color: white;
          padding: 20px;
          border-radius: 5px;
          width: 80%;
          max-width: 500px;
        }
        .gopersonal-audio-search-modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        #gopersonal-audio-search-closeVoiceSearch {
          cursor: pointer;
          font-size: 24px;
        }
        #gopersonal-audio-search-voiceMicContainer {
          display: flex;
          justify-content: center;
          margin-top: 20px;
        }
        .gopersonal-audio-search-circle {
          width: 80px;
          height: 80px;
          border-radius: 50%;
          background: #ffffff;
          display: flex;
          justify-content: center;
          align-items: center;
          box-shadow: 0 6px 10px 0 rgba(0, 0, 0, .14);
          cursor: pointer;
          transition: all 0.3s ease;
        }
        .gopersonal-audio-search-circle.gopersonal-audio-search-active {
          background: #ff0000;
          animation: gopersonal-audio-search-pulse 1.5s infinite;
        }
        .gopersonal-audio-search-circle svg {
          fill: #b2b1b1;
          transition: all 0.3s ease;
        }
        .gopersonal-audio-search-circle.gopersonal-audio-search-active svg {
          fill: #ffffff;
        }
        @keyframes gopersonal-audio-search-pulse {
          0% { transform: scale(1); }
          50% { transform: scale(1.1); }
          100% { transform: scale(1); }
        }
        .gopersonal-audio-search-fa-spin {
          animation: gopersonal-audio-search-spin 1s linear infinite;
        }
        @keyframes gopersonal-audio-search-spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `,document.head.appendChild(a)}(),document.getElementById("gopersonal-audio-search-voiceMicContainer").addEventListener("click",()=>s()),document.getElementById("gopersonal-audio-search-closeVoiceSearch").addEventListener("click",()=>{e.style.display="none",o&&s()})}(a),e.style.display="flex",document.getElementById("gopersonal-audio-search-voiceMicContainer").onclick=()=>s(i)}}}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=AudioSearch:window.AudioSearch=AudioSearch;const ImageSearch=function(){let e={};async function a(a,o){let i;e.startLoading?e.startLoading():(i=function e(){let a=document.createElement("div");return a.id="gopersonal-image-search-loadingIndicator",a.style.display="none",a.innerHTML='<div class="gopersonal-image-search-spinner"></div>',a}(),document.body.appendChild(i),i.style.display="flex");let r=new FormData;r.append("image",a);try{let n=window.gsSDK.getSession().sessionId+"-"+new Date().getTime(),s=window.location.search.includes("gsIncludeDraft=true")?"&gsIncludeDraft=true":"",t={limit:e.limit||1},c=await window.gsSDK.imageSearch(r,t);if(e.hideLoading?e.hideLoading():i&&(i.style.display="none",document.body.removeChild(i)),c.hits&&c.hits.length>0){let l=c.hits[0].name,d=`/catalogo?q=${l}&_gsSearchId=${n}${s}`;o(null,{url:d,data:c})}else o(null,{data:c})}catch(p){e.hideLoading?e.hideLoading():i&&(i.style.display="none",document.body.removeChild(i)),console.error("Error during image search:",p),o(p)}}return{open:function(o={},i){e.initialized?e={...e,...o}:(!function a(o={}){(e={...o}).startLoading&&e.hideLoading||function e(){let a=document.createElement("style");a.textContent=`
            #gopersonal-image-search-loadingIndicator {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            }
            .gopersonal-image-search-spinner {
                border: 5px solid #f3f3f3;
                border-top: 5px solid #3498db;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                animation: gopersonal-image-search-spin 1s linear infinite;
            }
            @keyframes gopersonal-image-search-spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `,document.head.appendChild(a)}()}(o),e.initialized=!0);let r=document.createElement("input");r.type="file",r.accept="image/*",r.onchange=async e=>{let o=e.target.files[0];o&&a(o,i)},r.click()}}}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=ImageSearch:window.ImageSearch=ImageSearch;